include ../mixins/forms.jade
extends ../layout

block content
  - var action = base + '/' + path
  - action += doc.isNew ? '' : '/' + doc._id
  - var id = doc.isNew ? '' : doc._id

  h2= ( (id) ? "Edit " : "New " ) + ( (meta.name) ? meta.name : meta.model )

  #form
    form.form-horizontal(method="post", action=action, enctype="multipart/form-data", role="form")
      input(type="hidden", name="_csrf", value="#{csrf_token}")
      input(type="hidden", name="_doc_id", value=id)

      each f in edit
        +makeField(field[f])
      .form-group
        .col-sm-2
        .col-sm-10
          #form-btn
            button.btn.btn-primary(type='submit') Save changes
              &nbsp;
            a.btn(href='#{base}/#{path}', title="cancel") Cancel

            if !doc.isNew
              #del-btn
                form(action=action+'/delete' method="post")
                  button.btn.btn-danger(type='submit') Delete

